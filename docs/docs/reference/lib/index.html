<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-reference/lib">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@400;500;700&family=Roboto+Mono:wght@400;700&display=swap">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.0.0-beta.74/dist/themes/dark.css">
<script src="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.0.0-beta.74/dist/shoelace.js" type="module"></script><title data-rh="true">Standard Library | OpenGOAL</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://open-goal.github.io/docs/reference/lib"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Standard Library | OpenGOAL"><meta data-rh="true" name="description" content="Runtime Functions"><meta data-rh="true" property="og:description" content="Runtime Functions"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://open-goal.github.io/docs/reference/lib"><link data-rh="true" rel="alternate" href="https://open-goal.github.io/docs/reference/lib" hreflang="en"><link data-rh="true" rel="alternate" href="https://open-goal.github.io/docs/reference/lib" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.09ceced1.css">
<link rel="preload" href="/assets/js/runtime~main.9bd2fce1.js" as="script">
<link rel="preload" href="/assets/js/main.042d6f4a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="OpenGOAL Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="OpenGOAL Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">OpenGOAL</b></a><a class="navbar__item navbar__link" href="/progress">Progress</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/open-goal" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">An Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/language-reference">Language Reference</a><button aria-label="Toggle the collapsible sidebar category &#x27;Language Reference&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/type_system">OpenGOAL&#x27;s Type System</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/method_system">OpenGOAL&#x27;s Method System</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/syntax">OpenGOAL Syntax &amp; Examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/reference/lib">Standard Library</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/reader">Reader</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/goos">GOOS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/object_file_formats">Object File Formats</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/process_and_state">Process and State</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/decompiler_states">States in the Decompiler</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/usage">Usage</a><button aria-label="Toggle the collapsible sidebar category &#x27;Usage&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/developing">Developing</a><button aria-label="Toggle the collapsible sidebar category &#x27;Developing&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/pc-port-info">PC Port Info</a><button aria-label="Toggle the collapsible sidebar category &#x27;PC Port Info&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="docItemContainer_Adtb"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/language-reference"><span itemprop="name">Language Reference</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Standard Library</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Standard Library</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="runtime-functions">Runtime Functions<a class="hash-link" href="#runtime-functions" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="string-symbol"><code>string-&gt;symbol</code><a class="hash-link" href="#string-symbol" title="Direct link to heading">​</a></h3><h3 class="anchor anchorWithStickyNavbar_LWe7" id="symbol-string"><code>symbol-&gt;string</code><a class="hash-link" href="#symbol-string" title="Direct link to heading">​</a></h3><h3 class="anchor anchorWithStickyNavbar_LWe7" id="format"><code>format</code><a class="hash-link" href="#format" title="Direct link to heading">​</a></h3><p>GOAL&#x27;s <code>printf</code>.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">format</span><span class="token plain"> destination format-string args...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The following destinations are currently supported:</p><ul><li><code>#t</code> - print to the listener. After the current game frame is over, this will be sent to the compiler and you can see it at the GOAL prompt.</li><li><code>0</code> - print to <code>stdout</code> in the runtime immediately. This won&#x27;t be visible from within the compiler - you must look at the runtime to see it. This is useful for debugging if the runtime crashes before flushing the normal print buffer.</li><li><code>#f</code> - print to a new string allocated on the global heap.</li><li>a GOAL <code>string</code> object - append to an existing string</li><li>a GOAL <code>file-stream</code> object - currently unsupported but eventually may allow printing into a file somewhere</li></ul><p>The global variable <code>*print-column*</code> can be used to automatically print at a certain indentation. The very first thing printed during a frame will not have the indentation applied.</p><p>The format string escape sequences all start with <code>~</code>, then have arguments (possibly none), then have a single character code. The arguments look like:</p><ul><li><code>~A</code>, the <code>A</code> code with no arguments</li><li><code>~12A</code>, the <code>A</code> code with an integer argument of <code>12</code></li><li><code>~&#x27;zA</code>, the <code>A</code> code with a character argument of <code>z</code></li><li><code> ~`hello`A</code>, the <code>A</code> code with a string argument of <code>&quot;hello&quot;</code></li><li><code>~12,&#x27;bA</code>, the <code>A</code> code with two arguments, integer <code>12</code> and character <code>b</code></li></ul><p>The escape codes are:</p><h4><code>~%</code></h4><p>Replace with a newline character.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="-1"><code>~~</code><a class="hash-link" href="#-1" title="Direct link to heading">​</a></h4><p>Replace with a <code>~</code> character</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="g-or-g"><code>~G</code> or <code>~g</code><a class="hash-link" href="#g-or-g" title="Direct link to heading">​</a></h4><p>Replace with a C-style string given in <code>args</code>. Note that this will not work on a GOAL string.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="a-or-a"><code>~A</code> or <code>~a</code><a class="hash-link" href="#a-or-a" title="Direct link to heading">​</a></h4><p>Print a boxed object given in <code>args</code>. Uses the <code>print</code> method. Can take optional arguments for length and padding character. If the <code>print</code> method gives something shorter than the length argument, it will be padded on the left with the padding character (default is space). If the <code>print</code> method gives something too long, it will be truncated on the right. The last character printed will be changed to <code>~</code> to indicate it was truncated here.</p><p>There is an option to left justify instead but I don&#x27;t think there&#x27;s a way to turn it on.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="s-or-s"><code>~S</code> or <code>~s</code><a class="hash-link" href="#s-or-s" title="Direct link to heading">​</a></h4><p>Very similar to <code>~A</code>, but a GOAL string will be printed without quotes around it.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="c-or-c"><code>~C</code> or <code>~c</code><a class="hash-link" href="#c-or-c" title="Direct link to heading">​</a></h4><p>Print a single character (GOAL <code>uint8</code> or <code>int8</code> type)</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="p-or-p"><code>~P</code> or <code>~p</code><a class="hash-link" href="#p-or-p" title="Direct link to heading">​</a></h4><p>Print an object, similar to <code>~A</code>, but does not have optional arguments for length or padding. Instead, there is an optional argument to give a type name, then use that types <code>print</code> method. This is useful for printing non-boxed objects. If no type name is given, behaves like <code>~A</code>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="i-or-i"><code>~I</code> or <code>~i</code><a class="hash-link" href="#i-or-i" title="Direct link to heading">​</a></h4><p>Like <code>~P</code>, but uses the inspect method instead.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="q-or-q"><code>~Q</code> or <code>~q</code><a class="hash-link" href="#q-or-q" title="Direct link to heading">​</a></h4><p>Likely was supposed to be for printing 128-bit integers stored in registers, but will always prints <code>0</code>. The <code>format</code> function is written in C using varargs, which doesn&#x27;t support 128-bit register values.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="b-or-b"><code>~B</code> or <code>~b</code><a class="hash-link" href="#b-or-b" title="Direct link to heading">​</a></h4><p>Print integer as binary. Optional arguments for pad-length and pad-character (default is 0). Won&#x27;t truncate.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="d-or-d"><code>~D</code> or <code>~d</code><a class="hash-link" href="#d-or-d" title="Direct link to heading">​</a></h4><p>Print integer as decimal (signed). Optional arguments for pad-length and pad-character (default is space). Won&#x27;t truncate.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="x-or-x"><code>~X</code> or <code>~x</code><a class="hash-link" href="#x-or-x" title="Direct link to heading">​</a></h4><p>Print integer as hex. Optional arguments for pad-length and pad-character (default is 0). Won&#x27;t truncate.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="f"><code>~F</code><a class="hash-link" href="#f" title="Direct link to heading">​</a></h4><p>Print floating point. Will print 4 digits after the decimal and pad with space to a width of 12 and does not accept any options.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="f-1"><code>~f</code><a class="hash-link" href="#f-1" title="Direct link to heading">​</a></h4><p>Print floating point. Takes optional arguments for pad-length (default don&#x27;t pad), pad-character (default space), and precision (default 4).</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="r-or-r"><code>~R</code> or <code>~r</code><a class="hash-link" href="#r-or-r" title="Direct link to heading">​</a></h4><p>Like <code>~f</code> but scales in-game rotation units to degrees. The float <code>65536.0</code> is 360 degrees.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="m-or-m"><code>~M</code> or <code>~m</code><a class="hash-link" href="#m-or-m" title="Direct link to heading">​</a></h4><p>Like <code>~f</code> but scales in-game distance units to meters. The float <code>4096.0</code> is 1 meter.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="e-or-e"><code>~E</code> or <code>~e</code><a class="hash-link" href="#e-or-e" title="Direct link to heading">​</a></h4><p>Like <code>~f</code> for argument, but takes an integer time-code as an input and scales time-code units to seconds. There are 300 ticks / second, which is the smallest number which has an integer number of ticks per NTSC and PAL frame. Something very weird happens when the input is negative?</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="t-or-t"><code>~T</code> or <code>~t</code><a class="hash-link" href="#t-or-t" title="Direct link to heading">​</a></h4><p>Insert a tab character.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="pass-through-codes">Pass Through Codes<a class="hash-link" href="#pass-through-codes" title="Direct link to heading">​</a></h4><p>Some codes will be passed through automatically, along with any arguments. This will also pass through arguments of <code>+</code> or <code>-</code>. I believe that these options could later be interpreted by the code for printing on-screen characters.</p><p>The pass through codes are <code>H,J,K,L,N,V,W,Y,Z,h,j,k,l,n,v,w,y,z</code>.</p><p>Any other codes will result in an error message being printed.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="block-forms">Block Forms<a class="hash-link" href="#block-forms" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="begin"><code>begin</code><a class="hash-link" href="#begin" title="Direct link to heading">​</a></h3><p>Execute forms in order.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">begin</span><span class="token plain"> form...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>A <code>begin</code> form is just a list of other forms which are executed in order. A <code>begin</code> form evaluates to the value of the last form.</p><p>Example:</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">print</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;hello &quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">print</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;world!&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token number">7</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>will print <code>hello world!</code> and the value of the entire form is <code>7</code>.</p><p>The <code>begin</code> form is used a lot in macros, but not that much in code. It&#x27;s generally used when you want to execute multiple things, but fit it into a single form.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="block"><code>block</code><a class="hash-link" href="#block" title="Direct link to heading">​</a></h3><p>A <code>block</code> form is pretty similar to a <code>begin</code>, except the <code>block</code> has a name. You can then &quot;return&quot; from the block early with <code>return-from</code>.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">block</span><span class="token plain"> block-name form...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Example:</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">block</span><span class="token plain"> my-block</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">print</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;hello &quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">return-from</span><span class="token plain"> my-block </span><span class="token number">7</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">print</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;world&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;test&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>will print <code>hello </code> only and the value of the entire <code>block</code> form is <code>7</code>. The type of the <code>block</code> is the most specific type that describes all of the possible return values from any <code>return-from</code> or from reaching the end (even if its technically not possible to reach the end). In the case above, the possible return types are <code>int</code> and <code>string</code>, so the return type of the whole block is <code>object</code>, the lowest common ancestor type of <code>int</code> and <code>string</code>.</p><p>Block is used rarely, and possibly almost never?</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="return-from"><code>return-from</code><a class="hash-link" href="#return-from" title="Direct link to heading">​</a></h3><p>Exit a <code>block</code> or function early.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">return-from</span><span class="token plain"> block-name value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Looks up the block and exits from it with the value. You can exit out nested blocks. If you are enclosed in multiple blocks with the same name, exits from the inner-most one with a matching name. Everything in a function is wrapped in a block named <code>#f</code>, so you can use <code>(return-from #f x)</code> to return early from a function with <code>x</code>. When using this form, it may change the return type of the function or block. The return type will be the lowest common ancestor type of all written return paths. If there is an unreachable return path, it will still be considered.</p><p>Example</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">is-a-match</span><span class="token plain">? x</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">return-from</span><span class="token plain"> #f x</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>if <code>x</code> is a match, returns <code>x</code> from the function (not shown) immediately.</p><p>The <code>return-from</code> form is very rarely used to return from a block, but sometimes used to return from a function.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="return"><code>return</code><a class="hash-link" href="#return" title="Direct link to heading">​</a></h3><p>Exit a function early.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Has the same behavior as <code>(return-from #f value)</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="label"><code>label</code><a class="hash-link" href="#label" title="Direct link to heading">​</a></h3><p>Create a named label for <code>goto</code> or <code>goto-when</code>.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">label</span><span class="token plain"> label-name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The label spaces are per-function and not nested. You can&#x27;t jump from function to function. You can&#x27;t jump in or out of functions which end up getting inlined. You can&#x27;t jump in or out of an anonymous lambda function. You can jump in and out of <code>let</code>s.</p><p>See <code>goto</code> for an example.</p><p>Labels are used extremely rarely. Usually only in inline assembly and part of macros for <code>while</code> loops and similar.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="goto"><code>goto</code><a class="hash-link" href="#goto" title="Direct link to heading">​</a></h3><p>Jump to a label.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">goto</span><span class="token plain"> label-name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The label must be in the current label space. You can jump forward or backward.</p><p>Example:</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> skip-code?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">goto</span><span class="token plain"> end</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">;; code here runs only if skip-code is false.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">label</span><span class="token plain"> end</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>goto</code> form used very rarely outside of macros and inline assembly. Try to avoid using <code>goto</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="top-level"><code>top-level</code><a class="hash-link" href="#top-level" title="Direct link to heading">​</a></h3><p>This form is reserved by the compiler. Internally all forms in a file are grouped under a <code>top-level</code> form, so you may see this in error messages. Do not name anything <code>top-level</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="control-flow-forms">Control Flow Forms<a class="hash-link" href="#control-flow-forms" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="goal-two-element-conditions">GOAL &quot;Two Element&quot; Conditions<a class="hash-link" href="#goal-two-element-conditions" title="Direct link to heading">​</a></h3><p>These are <code>!=</code>, <code>eq?</code>, <code>neq?</code>, <code>=</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>. The default is to compare the two objects as unsigned 64-bit integers, unless a special case is hit. The special case is determined by the type of the <strong>first</strong> argument:</p><ul><li>Floating point: if second argument is a number, convert to floating point. Use floating point comparisons</li><li>Binteger: convert first argument to integer. If second argument is a number, convert to integer. Use signed integer comparisons</li><li>Integer: If second argument is a number, convert to integer. Use signed integer comparison</li><li>Unsigned Integer: If second argument is a number, convert to integer. Use unsigned integer comparison</li></ul><p>Note that comparing structures just checks if they refer to the same memory, not if the contents are the same.</p><p>Currently there is absolutely no type checking done on comparisons, which makes it quite easy to get things wrong.</p><p>When a two-element condition is used as a condition for an <code>if</code>, <code>cond</code>, <code>while</code>, <code>goto-when</code>, or any other branching condition, there is an optimization that avoids computing a GOAL boolean, then checking that GOAL boolean as a branch condition. Instead the comparison operation directly sets the x86-64 flags for a jump. Original GOAL has a similar optimization.</p><p>There are a lot of unknown details</p><ul><li>What order are things evaluated / converted?</li><li>How does the order work when there&#x27;s a <code>not</code>?</li><li>Type Checking is probably needed.</li><li>Currently <code>=</code> and <code>eq?</code> are exactly the same. Likely <code>=</code> should only work on numbers and <code>eq?</code> should work on references?</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="not"><code>not</code><a class="hash-link" href="#not" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">not</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If value is <code>#f</code>, return <code>#t</code>. Otherwise return <code>#f</code>.</p><p>Using <code>not</code> on a &quot;two element condition&quot; will be optimized to modifying that condition.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="when-goto"><code>when-goto</code><a class="hash-link" href="#when-goto" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">when-goto</span><span class="token plain"> value-or-condition destination</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Examples:</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">when-goto</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">&gt;</span><span class="token plain"> x y</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> some-label</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">when-goto</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">is-player-dead</span><span class="token plain">?</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> some-label</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Jump to <code>destination</code> if the condition is truthy (not <code>#f</code>). This ends up generating much better code than <code>(if condition (goto x))</code>.</p><p>Like normal <code>goto</code>, this isn&#x27;t used much outside of macros.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cond"><code>cond</code><a class="hash-link" href="#cond" title="Direct link to heading">​</a></h3><p>A normal Lisp/Scheme <code>cond</code>.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">cond</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">test</span><span class="token plain"> clause...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Evaluates <code>test</code>s until one is truthy. Then evaluates all <code>clause</code>s in that case and returns the value of the last one. Optionally there can be a case with <code>else</code> as the test which runs if no other cases match. This must be the last case.</p><p>If there is no <code>else</code>, and no cases match, return <code>#f</code>. (is it always <code>#f</code>?)</p><p>The return type is the lowest common ancestor type of all cases. Note that for a <code>cond</code> without <code>else</code>, the possible return value of <code>#f</code> is <strong>not</strong> considered when determining the return type. So:</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">print-type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">cond</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">test1</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;hi&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">test2</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;bye&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>will print <code>[TYPE] string</code>, even though <code>cond</code> may return <code>#f</code>.</p><p>This behavior seems correct if the return value is a <code>basic</code>, but less clear if the return value is supposed to be a number.</p><p>Note that GOAL will load <code>#f</code> into a register for an else case even if the value of the <code>cond</code> is never used. Also, even if the value of the <code>cond</code> is never used, all cases will store their result into a common <code>cond</code> return-register. This is incredibly helpful for the decompiler!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="if"><code>if</code><a class="hash-link" href="#if" title="Direct link to heading">​</a></h3><p>A normal Lisp/Scheme <code>if</code>.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> test true-case </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">false-case</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The value of the entire statement is the value of the taken case. The false case can be left out. If the condition evaluates to false and the false case is left out, <code>#f</code> is returned. The return type follows the same logic as <code>cond</code>, as <code>if</code> is a macro using <code>cond</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="when"><code>when</code><a class="hash-link" href="#when" title="Direct link to heading">​</a></h3><p>A normal Lisp/Scheme <code>when</code>.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">when</span><span class="token plain"> test forms...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If <code>test</code> is truthy, evaluate all forms and return the value of the last one. If <code>test</code> isn&#x27;t true, return <code>#f</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="unless"><code>unless</code><a class="hash-link" href="#unless" title="Direct link to heading">​</a></h3><p>A normal Lisp/Scheme <code>unless</code>.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">unless</span><span class="token plain"> test forms...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If <code>test</code> is false, evaluate all forms and return the value of the last one. If <code>test</code> isn&#x27;t false, return <code>#f</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="definition-forms">Definition Forms<a class="hash-link" href="#definition-forms" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="set"><code>set!</code><a class="hash-link" href="#set" title="Direct link to heading">​</a></h3><p>Set a value!</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">set!</span><span class="token plain"> place value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Sets <code>place</code> to <code>value</code>. The <code>place</code> can be once of:</p><ul><li>A lexical variable defined by <code>let</code>, or an argument of a function</li><li>A global symbol</li><li>A <code>car</code> or <code>cdr</code> of a pair</li><li>A field of an object</li><li>A dereferenced pointer</li><li>An element in an array</li><li>A bitfield within any of the above (not yet implemented)</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="define"><code>define</code><a class="hash-link" href="#define" title="Direct link to heading">​</a></h3><p>Define a global symbol</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">define</span><span class="token plain"> symbol-name value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Kind of like <code>set!</code>, but works exclusively on global symbols. Also sets the type of the global symbol. If the global symbol already has a type, and the <code>define</code> tries to change it, there will be an error or warning. (to be determined)</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="define-extern"><code>define-extern</code><a class="hash-link" href="#define-extern" title="Direct link to heading">​</a></h3><p>Inform the compiler about the type of a global symbol</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">define-extern</span><span class="token plain"> symbol-name type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Useful to forward declare functions or to let the compiler know about things in the C Kernel. See <code>goal-externs.gc</code> for where all the C Kernel stuff is declared.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="let"><code>let</code><a class="hash-link" href="#let" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">var-name</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> body...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Define local variables. The variables are automatically assigned a type, like C++ <code>auto</code>.</p><p>Example:</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">count-1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">+</span><span class="token plain"> a b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">   </span><span class="token comment" style="color:rgb(98, 114, 164)">;; count_1 = a + b</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">count-2</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">+</span><span class="token plain"> c d</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">;; count_2 = c + d</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">count</span><span class="token plain"> &gt; </span><span class="token number">10</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">;; print a message if count &gt; 10.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">format</span><span class="token plain"> #t </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;count = ~</span><span class="token string argument" style="color:rgb(255, 121, 198)">D</span><span class="token string" style="color:rgb(255, 121, 198)">, ~D~%&quot;</span><span class="token plain"> count-1 count-2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note, if you define multiple variables in a <code>let</code>, you cannot refer to variables defined previously in the same <code>let</code>. In the example above, <code>count-2</code>&#x27;s value couldn&#x27;t be defined in terms of <code>count-1</code> for example. See <code>let*</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="let-1"><code>let*</code><a class="hash-link" href="#let-1" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">var-name</span><span class="token plain"> value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> body...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Define local variables. If you define multiple in a single <code>let*</code>, you can refer to previous variables.</p><p>Example:</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let*</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">count-1</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">+</span><span class="token plain"> a b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">count-2</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">+</span><span class="token plain"> count-1 d</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">;; okay because we used let*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">count</span><span class="token plain"> &gt; </span><span class="token number">10</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">;; print a message if count &gt; 10.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">format</span><span class="token plain"> #t </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;count = ~</span><span class="token string argument" style="color:rgb(255, 121, 198)">D</span><span class="token string" style="color:rgb(255, 121, 198)">, ~D~%&quot;</span><span class="token plain"> count-1 count-2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="functions">Functions<a class="hash-link" href="#functions" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="defun"><code>defun</code><a class="hash-link" href="#defun" title="Direct link to heading">​</a></h3><p>Define a new named global function!</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">defun</span><span class="token plain"> name arg-list </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;doc-string&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> body...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">arg-list = </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">arg</span><span class="token plain">...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">arg = </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">arg-name</span><span class="token plain"> arg-type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">|arg-name</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Example:</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">defun</span><span class="token plain"> 1/ </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">x</span><span class="token plain"> float</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Compute 1.0 / x&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">/</span><span class="token plain"> </span><span class="token number">1.0</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Define a new function with the given name. Note that until the <code>defun</code> itself executes, the function <strong>cannot be used!</strong>. So don&#x27;t call functions before the <code>defun</code>. This is unlike C, where you can forward declare a function and use it before the actual definition.</p><p>There is an optional docstring. Currently the docstring is just thrown away but in the future we could save them and and generate documentation or something.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="defmethod"><code>defmethod</code><a class="hash-link" href="#defmethod" title="Direct link to heading">​</a></h3><p>Define a method!</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">defmethod</span><span class="token plain"> method-name type-name arg-list </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;doc-string&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> body...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In many ways is similar to <code>defun</code>. See section on methods for more details.</p><p>You can only <code>defmethod</code> if one of these two is true:</p><ul><li>You are overriding a parent method</li><li>You have declared this method in the type&#x27;s <code>deftype</code></li></ul><p>Like <code>defun</code>, the method only exists after the <code>defmethod</code> executes. Before that the method may be undefined or the parent&#x27;s method.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="inline"><code>inline</code><a class="hash-link" href="#inline" title="Direct link to heading">​</a></h3><p>Make this function call inlined.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">inline</span><span class="token plain"> function-name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Example: inline call <code>my-function</code></p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">inline</span><span class="token plain"> my-function</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> my-arg</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Attempts to make the function call inline. If it is not possible, it will throw an error. You can&#x27;t save the value of <code>(inline my-function)</code>, only use it immediately in a function call. You must provide a name of a global function as the function, not a function pointer.</p><p>Methods cannot be inlined. (Maybe new methods can be in original GOAL?)</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="lambda"><code>lambda</code><a class="hash-link" href="#lambda" title="Direct link to heading">​</a></h3><p>Create a GOAL Lambda.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">lambda</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:name</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:inline-only</span><span class="token plain"> #f|#t</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:segment</span><span class="token plain"> main|debug</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> arg-list body-form..</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">arg-list = </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">arg</span><span class="token plain">...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">arg = </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">arg-name</span><span class="token plain"> arg-type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">|arg-name</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>:name</code> option is only used for debugging the compiler - it cannot be accessed or referenced outside of internal compiler debugging features. It should be ignored unless you are debugging the compiler.</p><p>The <code>:inline-only</code> flag defaults to <code>#f</code>, but can be set to <code>#t</code> to force the compiler to not generate x86-64 code for the function. In this case, the lambda cannot be used as a function pointer/GOAL <code>function</code> object. This is used in the <code>let</code> macro and not really useful for general programming. If the flag is <code>#f</code> (default value), it will generate and store an x86-64 function, regardless of if the function is ever called.</p><p>The <code>:segment</code> option defaults to <code>main</code>, unless the <code>lambda</code> is defined in a function in the <code>debug</code> segment, in which case it defaults to <code>debug</code>. It can be overridden by this flag. This picks the segment of the object file where the function will be stored.</p><p>The arguments default to type of <code>object</code> if no type is provided. In the case where a lambda is used immediately (a <code>let</code>) the compiler will propagate more specific types. This is why you don&#x27;t have to give types when using <code>let</code>.</p><p>A GOAL lambda has three purposes:</p><ol><li>Generate a function as a &quot;real&quot; x86-64 function.</li><li>Save the code so the function can later be inlined</li><li>Immediately use the lambda in the head of a list as part of a <code>let</code> or <code>let*</code> macro</li></ol><p><strong>Example of 1:</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">(sort my-list (lambda ((x int) (y int) (&lt; x y))))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We create a real x86-64 function to pass to the <code>sort</code> function. In this case you should specify types - the default of <code>object</code> is not suitable.</p><p>The other two cases are handled by <code>let</code> and <code>defun</code> macros, and shouldn&#x27;t show up in other places, so they are left out.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="declare"><code>declare</code><a class="hash-link" href="#declare" title="Direct link to heading">​</a></h3><p>Set options for a function or method</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token declare keyword" style="color:rgb(189, 147, 249);font-style:italic">declare</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">inline</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">allow-inline</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">disallow-inline</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">asm-func</span><span class="token plain"> return-typespec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">print-asm</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If used, this should be the first thing inside of a <code>defun</code>/<code>defmethod</code>. Don&#x27;t use it anywhere else.
Example:</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token defun keyword" style="color:rgb(189, 147, 249);font-style:italic">defun</span><span class="token defun"> </span><span class="token defun function" style="color:rgb(80, 250, 123)">my-function</span><span class="token defun"> </span><span class="token defun punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token defun arguments"></span><span class="token defun punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token declare keyword" style="color:rgb(189, 147, 249);font-style:italic">declare</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">inline</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>inline</code> means &quot;inline whenever possible&quot;. See function inlining section for why inlining may be impossible in some cases.</li><li><code>allow-inline</code> or <code>disallow-inline</code>. You can control if inlining is allowed, though it is not clear why I thought this would be useful. Currently the default is to allow always.</li><li><code>print-asm</code> if codegen runs on this function (<code>:color #t</code>), disassemble the result and print it. This is intended for compiler debugging.</li><li><code>asm-func</code> will disable the prologue and epilogue from being generated. You need to include your own <code>ret</code> instruction or similar. The compiler will error if it needs to use the stack for a stack variable or a spilled register. The coloring system will not use callee saved registers and will error if you force it to use one. As a result, complicated GOAL expression may fail inside an <code>asm-func</code> function. The intent is to use it for context switching routines inside in the kernel, where you may not be able to use the stack, or may not want to return with <code>ret</code>. The return type of an <code>asm-func</code> must manually be specified as the compiler doesn&#x27;t automatically put the result in the return register and cannot do type analysis to figure out the real return type.</li><li><code>allow-saved-regs</code> allows an <code>asm-func</code>&#x27;s coloring to use saved registers without an error. Stacks spills are still an error. The compiler will not automatically put things in a saved register, you must do this yourself. The move eliminator may still be used on your variables which use saved registers, so you should be careful if you really care about where saved variables are used.</li></ul><p>This form will probably get more options in the future.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="local-vars"><code>local-vars</code><a class="hash-link" href="#local-vars" title="Direct link to heading">​</a></h3><p>Declare variables local to a function, without an initial value. This will be used by the decompiler before <code>let</code> has been fully implemented.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">local-vars</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">name</span><span class="token plain"> type-spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The name can be any valid symbol. The scope of the variable is <em>always</em> the function scope. Other scopes inside a function will always hide variables declared with <code>local-vars</code>. The type can be any GOAL typespec. If you use <code>float</code>, you get a floating point register, otherwise you get a normal GPR.</p><p>It&#x27;s recommended to avoid using this form.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="macro-forms">Macro Forms<a class="hash-link" href="#macro-forms" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cond-1"><code>#cond</code><a class="hash-link" href="#cond-1" title="Direct link to heading">​</a></h3><p>This is like an <code>#ifdef</code>, but the language for the conditions is GOOS and it&#x27;s like a <code>cond</code>.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">#cond </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">test</span><span class="token plain"> clause...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>#cond</code> is executed at compile time. The cases which don&#x27;t match aren&#x27;t compiled. There are <code>#when</code> and <code>#unless</code> macros that work like you would expect.</p><p>Example:</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">#when PRINT_DEBUG_INFO</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">format</span><span class="token plain"> #t </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;debug info~%&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="quote--"><code>quote</code> / <code>&#x27;</code><a class="hash-link" href="#quote--" title="Direct link to heading">​</a></h3><p>The reader will expand <code>&#x27;thing</code> to <code>(quote thing)</code></p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">quote</span><span class="token plain"> thing</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Currently <code>quote</code> supports:</p><ul><li><code>&#x27;a-symbol</code> - will return the symbol <code>a-symbol</code></li><li><code>&#x27;()</code> - will return the empty list.</li></ul><p>In the future, it should support quoted lists of static data.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="defglobalconstant"><code>defglobalconstant</code><a class="hash-link" href="#defglobalconstant" title="Direct link to heading">​</a></h3><p>Define a GOOS and GOAL constant.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">defconstant</span><span class="token plain"> name value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The constant is available in both GOOS and GOAL. You can use it in <code>#cond</code> expressions (GOOS) and in GOAL code. The constant inserts the <code>value</code> as an s-expression in the code. This means it&#x27;s a &quot;code&quot; constant, and doesn&#x27;t have a type.</p><p>There are a few restrictions:</p><ul><li>Currently constants do not work in <code>deftype</code>. (this should be fixed eventually)</li><li>Constants may not work in places where the compiler is expecting a symbol which isn&#x27;t actually compiled. So <code>(+ MY_CONSTANT 2)</code> is fine, but <code>(defun MY_CONSTANT () ...)</code> isn&#x27;t. Don&#x27;t use constants for type names, function names, or symbol names. It is fine to have a constant with a value of a symbol, but don&#x27;t <code>(define MY_CONSTANT)</code> or <code>(set! MY_CONSTANT)</code> or <code>(new MY_CONSTANT)</code> or things like that.</li><li>Don&#x27;t use constants with <code>method</code> form.</li><li>You can modify constants created with <code>defglobalconstant</code> in GOOS (effect won&#x27;t be seen in GOAL) with <code>(set!)</code></li><li>There is no warning if one <code>defglobalconstant</code> changes the value of an existing <code>defglobalconstant</code></li></ul><p>In general constants should have <code>UPPERCASE</code> names otherwise things get very confusing when there are name conflicts.</p><p>The recommendation is to use constants for things like numbers or expressions like <code>(* NUM_THINGS SIZE_OF_EACH_THING)</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mlet"><code>mlet</code><a class="hash-link" href="#mlet" title="Direct link to heading">​</a></h3><p>Scoped constants in GOAL. Syntax is like a <code>let</code>. This feature has all the restrictions of <code>defglobalconstant</code>.
Avoid using <code>mlet</code> because it&#x27;s confusing and not useful.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">mlet</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">constant-name</span><span class="token plain"> constant-value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  body...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Example:</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">mlet</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">NUM-THINGS</span><span class="token plain"> </span><span class="token number">12</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">THING-NAME</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;test&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">; in here, NUM-THING and THING-NAME are constants</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="math-forms">Math Forms<a class="hash-link" href="#math-forms" title="Direct link to heading">​</a></h2><p>Math forms will look at the type of the first argument to determine the &quot;mode&quot;. So if you have <code>(+ 1 1.2)</code>, it will convert the <code>1.2</code> to an integer, do the add, and return an integer.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="-2"><code>+</code><a class="hash-link" href="#-2" title="Direct link to heading">​</a></h3><p>Addition. Can take 1 or more arguments. <code>(+ 1)</code> will give you <code>1</code>, like you&#x27;d expect.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">+</span><span class="token plain"> form...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Works on integers and floats. Integer add is 64-bit and wrapping.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="-"><code>-</code><a class="hash-link" href="#-" title="Direct link to heading">​</a></h3><p>Subtraction or negative. Can take 1 or more arguments.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">-</span><span class="token plain"> form...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>(- 1)</code> gives you <code>-1</code>, but <code>(- 1 3)</code> gives you <code>-2</code>, which may be slightly confusing at first. Works on integers and floats. Integer subtract is 64-bit and wrapping.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="-3"><code>*</code><a class="hash-link" href="#-3" title="Direct link to heading">​</a></h3><p>Multiplication. Can take 1 or more arguments.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">*</span><span class="token plain"> form...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>(* 7)</code> will become <code>7</code>, as you&#x27;d expect. Works on integers and floats. The exact behavior for integers needs to be explored more because the EE is weird. GOAL generates different code for multiplication of signed vs. unsigned integers.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="-4"><code>/</code><a class="hash-link" href="#-4" title="Direct link to heading">​</a></h3><p>Division. Takes exactly two arguments</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">/</span><span class="token plain"> dividend divisor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Works on floats and integers. The exact behavior for integers needs to be explored more because the EE is weird. GOAL generates different code for division of signed vs. unsigned integers.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mod"><code>mod</code><a class="hash-link" href="#mod" title="Direct link to heading">​</a></h3><p>Modulo operation. Takes exactly two arguments.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">/</span><span class="token plain"> dividend divisor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Works on integers only. The exact behavior needs to be explored because the EE is weird. It is unknown if the same code is generate for signed/unsigned mod.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="slhv-sarv-shrv"><code>slhv</code>, <code>sarv</code>, <code>shrv</code><a class="hash-link" href="#slhv-sarv-shrv" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">shlv</span><span class="token plain"> value shift-amount</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The exact behavior of GOAL shifts isn&#x27;t fully understood, so these are temporary wrappers around x86-64 variable shift instructions.</p><ul><li><code>shlv</code> shift left variable</li><li><code>sarv</code> shift arithmetic right variable</li><li><code>shrv</code> shift logical right variable
64-bit operation.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="logand"><code>logand</code><a class="hash-link" href="#logand" title="Direct link to heading">​</a></h3><p>Bitwise And</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">logand</span><span class="token plain"> a b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>64-bit operation.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="logior"><code>logior</code><a class="hash-link" href="#logior" title="Direct link to heading">​</a></h3><p>Bitwise Inclusive Or (normal Or)</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">logior</span><span class="token plain"> a b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>64-bit operation.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="logxor"><code>logxor</code><a class="hash-link" href="#logxor" title="Direct link to heading">​</a></h3><p>Bitwise Exclusive Or (Xor</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">logxor</span><span class="token plain"> a b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>64-bit operation.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="lognot"><code>lognot</code><a class="hash-link" href="#lognot" title="Direct link to heading">​</a></h3><p>Bitwise Not</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">lognot</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>64-bit operation.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="type-forms">Type Forms<a class="hash-link" href="#type-forms" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="defmethod-1"><code>defmethod</code><a class="hash-link" href="#defmethod-1" title="Direct link to heading">​</a></h3><h3 class="anchor anchorWithStickyNavbar_LWe7" id="deftype"><code>deftype</code><a class="hash-link" href="#deftype" title="Direct link to heading">​</a></h3><h3 class="anchor anchorWithStickyNavbar_LWe7" id="method-of-object"><code>method-of-object</code><a class="hash-link" href="#method-of-object" title="Direct link to heading">​</a></h3><p>Get a method of an object.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">method-of-object</span><span class="token plain"> object method-name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This form takes an object and gets the method from it. If the object has runtime type information, will consult the method table at runtime to get a possibly more specific method than what is available at compile time. This uses the same lookup logic as method calling - see the section on method calls for more information.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="method-of-type"><code>method-of-type</code><a class="hash-link" href="#method-of-type" title="Direct link to heading">​</a></h3><p>Get a method of a type or an object.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">method-of-type</span><span class="token plain"> type method-name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The first form of this takes a type name and method name and returns a GOAL <code>function</code> for this method. For example:</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">method</span><span class="token plain"> string inspect</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>will return the <code>inspect</code> method of <code>string</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="car-and-cdr"><code>car</code> and <code>cdr</code><a class="hash-link" href="#car-and-cdr" title="Direct link to heading">​</a></h3><p>Get element from pair</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">car</span><span class="token plain"> some-pair</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">cdr</span><span class="token plain"> some-pair</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The type of the result is always <code>object</code>, as pairs can hold any <code>object</code>. The type-check for <code>car</code> and <code>cdr</code> is relaxed - it allows it to be applied to any <code>pair</code> or <code>object</code>. The reason for allowing <code>object</code> is so you can write <code>(car (car x))</code> instead of <code>(car (the pair (car x)))</code>. However, if the argument to <code>car</code> is not a <code>pair</code>, you will get garbage or a crash.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="new"><code>new</code><a class="hash-link" href="#new" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">new</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">allocation</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">new-type-specification</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">args</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>See section on creating new GOAL objects.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="print-type"><code>print-type</code><a class="hash-link" href="#print-type" title="Direct link to heading">​</a></h3><p>Print the type of some GOAL expression at compile time.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">print-type</span><span class="token plain"> form</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This is mainly used to debug the compiler or figure out why some code is failing a type check. The thing inside is compiled fully and used as the result of <code>print-type</code>. Example:</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">print-type</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;apples&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)">;; [TYPE] string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">print-type</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">+</span><span class="token plain"> </span><span class="token number">12</span><span class="token plain"> </span><span class="token number">1.2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">;; [TYPE] int</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">print-type</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">the</span><span class="token plain"> float </span><span class="token number">12</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">;; [TYPE] float</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the"><code>the</code><a class="hash-link" href="#the" title="Direct link to heading">​</a></h3><p>Convert between types, doing the expected thing for number conversions.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">the</span><span class="token plain"> type thing</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If the <code>type</code> and the <code>thing</code> are both numbers, it will automatically convert between the different numeric types as needed. In all other cases, it does a dangerous <code>reinterpret_cast</code>. cppreference.com explains this idea clearly with &quot;Converts between types by reinterpreting the underlying bit pattern.&quot;</p><p>If the <code>thing</code> is a number:</p><ul><li>If <code>type</code> is <code>binteger</code>, convert the number to a <code>binteger</code></li><li>If <code>type</code> is <code>int</code> or <code>uint</code> (or some user-defined child type of these), convert the number to an integer.</li><li>If <code>type</code> is <code>float</code>, convert the number to a <code>float</code></li></ul><p>In all other cases, directly use the 64-bit value in the register as the value of the desired <code>type</code>.</p><p>Example of number conversions:</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">the</span><span class="token plain"> binteger </span><span class="token number">12</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">;; boxed integer for 12</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">the</span><span class="token plain"> float </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">     </span><span class="token comment" style="color:rgb(98, 114, 164)">;; floating point 1.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">the</span><span class="token plain"> int </span><span class="token number">1.234</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">   </span><span class="token comment" style="color:rgb(98, 114, 164)">;; signed integer 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Examples of common casts:</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">the</span><span class="token plain"> uint </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">             </span><span class="token comment" style="color:rgb(98, 114, 164)">;; unsigned integer, doesn&#x27;t do any modification if input is already an int.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">the</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">pointer</span><span class="token plain"> uint8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">;; like C (uint8_t*)x</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">the</span><span class="token plain"> string </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">car</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">     </span><span class="token comment" style="color:rgb(98, 114, 164)">;; if you know (car x) is a string, do this.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Examples of dangerous things you can do but probably shouldn&#x27;t:</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">the</span><span class="token plain"> string </span><span class="token number">1.234</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">;; take the binary representation of 1.234 and treat it as a GOAL memory address to string data.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">the</span><span class="token plain"> float </span><span class="token quoted-symbol variable symbol" style="color:rgb(248, 248, 242);font-style:italic">&#x27;bean</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">;; take the GOAL memory address of the &quot;bean&quot; symbol and treat it as the binary representation of a float.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>There are some weird edge cases with <code>the</code> that are worth mentioning, if you try to set the value of something you&#x27;ve used <code>the</code> on. In the future the compiler should block you from doing something bad, but this is not yet implemented.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">set!</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">the</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">pointer</span><span class="token plain"> uint8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">;; OK, not casting the actual value</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">set!</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">the</span><span class="token plain"> int </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">-&gt;</span><span class="token plain"> obj x</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">              </span><span class="token comment" style="color:rgb(98, 114, 164)">;; NOT OK. Int is a value type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">;; Will actually work if x is already an int/uint, and with non-numeric values types like pointer. Avoid just to be safe.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">set!</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">the</span><span class="token plain"> string </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">-&gt;</span><span class="token plain"> obj x</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;test&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">;; OK, string is a basic, which is a reference type.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This becomes more clear if we look at the C equivalent:</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">uint8_t*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">a-&gt;x</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> = 1</span><span class="token comment" style="color:rgb(98, 114, 164)">; // makes sense</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">int</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">a-&gt;x</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> = 1</span><span class="token comment" style="color:rgb(98, 114, 164)">; // doesn&#x27;t make sense</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">thing*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">a-&gt;x</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> = thing</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token comment" style="color:rgb(98, 114, 164)">; // makes sense</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-as"><code>the-as</code><a class="hash-link" href="#the-as" title="Direct link to heading">​</a></h3><p>Convert between types always using <code>reinterpret_cast</code></p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">the-as</span><span class="token plain"> type thing</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>cppreference.com explains this idea clearly with &quot;Converts between types by reinterpreting the underlying bit pattern.&quot;</p><p>The recommendation is to prefer <code>the</code> in almost all cases, unless you want to set an exact bit pattern of a <code>float</code>, or want to examine the bits in a <code>float</code>.</p><p>Example:</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">the-as</span><span class="token plain"> int </span><span class="token number">1.234</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">;; result happens to be 1067316150</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>None of the edge cases of <code>the</code> apply to <code>the-as</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="size-of"><code>size-of</code><a class="hash-link" href="#size-of" title="Direct link to heading">​</a></h3><p>Get the size of a type, in bytes.</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">size-of</span><span class="token plain"> &lt;type-name&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Get the size of a type, by name. The type must be a plain name, like <code>pointer</code> or <code>dma-bucket</code>. Compound types are not supported. It works on value and structure types and returns the size in memory. For dynamic types, it returns the size as if the dynamic part has 0 size. For weird types like <code>none</code> it throws an error.</p><p>This value can be used in most places where the compiler is expecting a constant integer as well, such as the size of a stack array, which must be known at compile time.</p><p>Example:</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">size-of</span><span class="token plain"> dma-bucket</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Returns the size of the <code>dma-bucket</code> type which is 16 bytes.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pointer-math">Pointer Math<a class="hash-link" href="#pointer-math" title="Direct link to heading">​</a></h3><p>Not implemented well yet.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="inline-assembly-forms">Inline Assembly Forms<a class="hash-link" href="#inline-assembly-forms" title="Direct link to heading">​</a></h2><p>In general, assembly forms have a name that begins with a <code>.</code>. They all evaluate to <code>none</code> and copy the form of an x86-64 instruction. For example <code>(.sub dst src)</code>. A destination must be a settable register (ok if it&#x27;s spilled). So you can&#x27;t do something like <code>(.sub (-&gt; obj field) x)</code>. Instead, do <code>(set! temp (-&gt; obj field))</code>, <code>(.sub temp x)</code>, <code>(set! (-&gt; obj field) temp)</code>.  The sources can be any expression, or a register. This allows you to mix high-level code with assembly easily, like <code>(.mov rax (-&gt; obj field))</code> or <code>(.push (+ 1 (-&gt; obj field)))</code>.</p><p>By default, assembly forms work with the coloring system. This means that assembly and high level expression can be mixed together without clobbering each other. It also means use of callee-saved registers will cause them to be backed up/restored in the function prologue and epilogue. Use of weird registers like <code>r15</code>, <code>r14</code>, and <code>rsp</code> works as you would expect with the coloring system.</p><p>But you can also request to skip this with <code>:color #f</code> option, like <code>(.push my-reg-var :color #f)</code>. Be very careful with this. The <code>:color #f</code> option will only work with register variables from <code>rlet</code> which have a manually specified register. It will entirely bypass the coloring system and use this register. Use of this near high level GOAL variables is extremely dangerous and should be done very carefully or avoided, as the GOAL compiler will not know that you could be modifying its registers. In a form with <code>:color #f</code>, you cannot use higher level code or variables - all variables must be defined in <code>rlet</code>s. This is because higher level expressions and variables cannot be used without the coloring system.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rlet"><code>rlet</code><a class="hash-link" href="#rlet" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">rlet</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">var-name</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:reg</span><span class="token plain"> reg-name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:class</span><span class="token plain"> reg-class</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:type</span><span class="token plain"> typespec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:reset-here</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">...</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  body...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Create register variables. You can optionally specify a register with the <code>:reg</code> option and a register name like <code>rax</code> or <code>xmm3</code>. The initial value of the register is not set. If you don&#x27;t specify a register, a GPR will be chosen for you by the coloring system and it will behave like a <code>let</code>. If you don&#x27;t specify a register, you can specify a register class (<code>gpr</code>, a normal 64-bit integer register; <code>fpr</code>, a 32-bit single precision float; or  <code>vf</code>, and 128-bit floating point vector register) and the compiler will pick a GPR or XMM for you.</p><p>If you pick a callee-saved register and use it within the coloring system, the compiler will back it up for you in the prologue and restore it in the epilogue.
If you pick a special register like <code>rsp</code>, it won&#x27;t be backed up.</p><p>Inside the <code>rlet</code>, all uses of <code>var-name</code> will always be in the given register. If the variable goes dead (or is never live), the compiler may reuse the register as it wants. The compiler may also spill the variable onto the stack. Of course, if you are in an <code>asm-func</code>, the stack will never be used. Be extremely careful about using &quot;normal&quot; registers without the coloring system and with higher-level code as the compiler may use your &quot;normal&quot; register as a temporary. If you read the value of a register and use the coloring system, the variable will then be alive starting at the beginning of the function, and will make that register unavailable to the compiler and other <code>rlet</code>s that occur before. This is useful to preserve the value of a temporary register if needed, but can also be undesirable in other cases. If you add the <code>:reset-here #t</code> flag, it will make the variable dead until the start of the <code>rlet</code>. It &quot;resets&quot; the value of the register in the coloring system at the start of the <code>rlet</code>. The default value is false. It is recommended to keep the default value when accessing specific registers that are also normally used by the compiler. For special registers like <code>rsp</code>, <code>r15</code>, <code>r14</code>, and <code>r13</code>, if you plan to use them with the coloring system, it is recommended to set the <code>reset-here</code> flag.</p><p>Here is an example of using an <code>rlet</code> to access registers:</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token defun keyword" style="color:rgb(189, 147, 249);font-style:italic">defun</span><span class="token defun"> </span><span class="token defun function" style="color:rgb(80, 250, 123)">get-goal-rsp-2</span><span class="token defun"> </span><span class="token defun punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token defun arguments"></span><span class="token defun punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Get the stack pointer as a </span><span class="token string argument" style="color:rgb(255, 121, 198)">GOAL</span><span class="token string" style="color:rgb(255, 121, 198)"> pointer&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">rlet</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">rsp</span><span class="token plain"> </span><span class="token lisp-property property">:reg</span><span class="token plain"> rsp </span><span class="token lisp-property property">:type</span><span class="token plain"> uint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">off</span><span class="token plain"> </span><span class="token lisp-property property">:reg</span><span class="token plain"> r15 </span><span class="token lisp-property property">:type</span><span class="token plain"> uint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">the</span><span class="token plain"> pointer </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">-</span><span class="token plain"> rsp off</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sub"><code>.sub</code><a class="hash-link" href="#sub" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.sub dest src </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>x86-64 subtraction (64-bit). If coloring is on (the default), the <code>dest</code> must be a settable register (<code>rlet</code> var, <code>let</code> var, function argument, ...). It can&#x27;t be a place like a symbol, field, stack variable, etc. If coloring is off, both <code>src</code> and <code>dest</code> must be registers defined and constrained in an enclosing <code>rlet</code>.</p><p>Example:</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token defun keyword" style="color:rgb(189, 147, 249);font-style:italic">defun</span><span class="token defun"> </span><span class="token defun function" style="color:rgb(80, 250, 123)">get-goal-rsp</span><span class="token defun"> </span><span class="token defun punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token defun arguments"></span><span class="token defun punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token declare keyword" style="color:rgb(189, 147, 249);font-style:italic">declare</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">asm-func</span><span class="token plain"> uint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">rlet</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">rsp</span><span class="token plain"> </span><span class="token lisp-property property">:reg</span><span class="token plain"> rsp </span><span class="token lisp-property property">:type</span><span class="token plain"> uint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">off</span><span class="token plain"> </span><span class="token lisp-property property">:reg</span><span class="token plain"> r15 </span><span class="token lisp-property property">:type</span><span class="token plain"> uint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">ret</span><span class="token plain"> </span><span class="token lisp-property property">:reg</span><span class="token plain"> rax </span><span class="token lisp-property property">:type</span><span class="token plain"> uint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)">;; mov rax, rsp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">set!</span><span class="token plain"> ret rsp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)">;; sub rax, r15</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.sub ret off</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)">;; ret</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.ret</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="add"><code>.add</code><a class="hash-link" href="#add" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.add dest src </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Addition (64-bit). Similar to subtraction.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="jr"><code>.jr</code><a class="hash-link" href="#jr" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.jr addres-reg </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Jump-register. Jumps to the address given. The address is treated as a 64-bit pointer, not a GOAL pointer.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="load-sym"><code>.load-sym</code><a class="hash-link" href="#load-sym" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.load-sym dest symbol-name </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:sext</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Load the value of a symbol into a register. By default, it will look at the type of the symbol to determine if it should be sign extended or not. You can override this with the <code>:sext</code> option if needed. The symbol must be known to the type system.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="push"><code>.push</code><a class="hash-link" href="#push" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.push src </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The x86-64 push instruction. Does a 64-bit GPR. The <code>src</code> can be any expression that can be put in a gpr if color is on. Otherwise it must be a register defined and constrained in an enclosing <code>rlet</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pop"><code>.pop</code><a class="hash-link" href="#pop" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.pop dst </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The x86-64 pop instruction. Does a 64-bit GPR. The <code>dst</code> can be any expression which evaluates to a settable register if color is on. Otherwise it must be a register defined and constrained in an enclosing <code>rlet</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ret"><code>.ret</code><a class="hash-link" href="#ret" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.ret </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The x86-64 ret instruction. The color option does nothing. This is not recognized as a control flow instruction by the coloring system. It does not touch the return register <code>rax</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mov"><code>.mov</code><a class="hash-link" href="#mov" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.mov dst src </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Move between two registers. The <code>dst</code> should be a register (either <code>rlet</code> or <code>let</code> variable), and the <code>src</code> can be a register or any expression. The following moves are supported:</p><ul><li><code>gpr</code> to <code>gpr</code></li><li><code>fpr</code> to <code>fpr</code> (only moves lower 32-bits of the xmms, uses <code>movss</code>)</li><li><code>vf</code> to <code>vf</code> (moves all 128-bits of the xmms, uses <code>vmovaps</code>)</li><li><code>gpr</code> to <code>fpr</code> (only moves 32-bits, uses <code>movd</code>)</li><li><code>fpr</code> to <code>gpr</code> (only moves 32-bits, upper 32-bits are zero, uses <code>movd</code>)
This code generation is identical to using a <code>(set! dst src)</code> form.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nopvf"><code>.nop.vf</code><a class="hash-link" href="#nopvf" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.nop.vf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Inserts a <code>FNOP</code> assembly instruction, which is fundamentally the same as a <code>NOP</code>. It is a 2-byte instruction.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nop-or-nop"><code>.nop</code> or <code>(nop!)</code><a class="hash-link" href="#nop-or-nop" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.nop</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">;; or</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">nop!</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Inserts a single-byte <code>nop</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="waitvf"><code>.wait.vf</code><a class="hash-link" href="#waitvf" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.wait.vf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Inserts a <code>FWAIT</code> assembly instruction, x86 does not require as much synchronization as the PS2&#x27;s VU registers did, but it has a purpose in rare cases. It is a 2-byte instruction.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="lvf"><code>.lvf</code><a class="hash-link" href="#lvf" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.lvf dst-reg src-loc </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:offset</span><span class="token plain"> &lt;int&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Load a vector float register from <code>src-loc</code>. The <code>dst-reg</code> must be a vector float register. The <code>src-loc</code> can be a gpr containing a GOAL pointer or expression which gives a GOAL pointer. There is no type checking on the <code>src-loc</code> so be careful. The load uses <code>vmovaps</code>, so the source must be 16-byte aligned.</p><p>If the source is in the form <code>base-reg + constant-offset</code>, like from a <code>(&amp;-&gt; my-object my-inline-vector-field)</code>, the constant offset will be folded into the load instruction like <code>vmovaps xmm1, [r15 + rax + 12]</code>. An explicit offset can be provided via the <code>:offset</code> keyword, and will be used if applicable.</p><p>If the source is an immediate <code>(new &#x27;static ...)</code> form that results in a statically allocated variable, it will use <code>RIP</code> relative addressing (32-bit immediate) form. This means that the code:</p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.lvf vf1 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token car">new</span><span class="token plain"> </span><span class="token quoted-symbol variable symbol" style="color:rgb(248, 248, 242);font-style:italic">&#x27;static</span><span class="token plain"> </span><span class="token quoted-symbol variable symbol" style="color:rgb(248, 248, 242);font-style:italic">&#x27;vector</span><span class="token plain"> </span><span class="token lisp-property property">:x</span><span class="token plain"> </span><span class="token number">1.2</span><span class="token plain"> </span><span class="token lisp-property property">:y</span><span class="token plain"> </span><span class="token number">2.3</span><span class="token plain"> </span><span class="token lisp-property property">:z</span><span class="token plain"> </span><span class="token number">3.4</span><span class="token plain"> </span><span class="token lisp-property property">:w</span><span class="token plain"> </span><span class="token number">5.6</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>will be just a single instruction to do a <code>vmovaps xmm1, [rip + XXX]</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="svf"><code>.svf</code><a class="hash-link" href="#svf" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.svf dst-loc src-reg </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:offset</span><span class="token plain"> &lt;int&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Store a vector float. Works similarly to the <code>lvf</code> form, but there is no optimized case for storing into a static because this isn&#x27;t allowed in GOAL.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="three-operand-vector-float-operations">Three operand vector float operations.<a class="hash-link" href="#three-operand-vector-float-operations" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.&lt;op-name&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">.&lt;broadcast-element&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">.vf dst src0 src1 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:mask</span><span class="token plain"> #b&lt;0-15&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>All the three operand forms work similarly. You can do something like <code>(.add.vf vf1 vf2 vf3)</code>. All operations use the similarly named <code>v&lt;op-name&gt;ps</code> instruction, xmm128 VEX encoding. We support the following <code>op-name</code>s:</p><ul><li><code>xor</code></li><li><code>add</code></li><li><code>sub</code></li><li><code>mul</code></li><li><code>min</code></li><li><code>max</code></li></ul><p>An optional <code>:mask</code> value can be provided as a binary number between 0-15 (inclusive). This determines <em>which</em> of the resulting elements will be committed to the destination vector. For example, <code>:mask #b1011</code> means that the <code>w</code>, <code>y</code> and <code>x</code> results will be committed. Note that the components are defined left-to-right which may be a little counter-intuitive -- <code>w</code> is the left-most, <code>x</code> is the right-most. This aligns with the PS2&#x27;s VU implementation.</p><p>Additionally, all of these operations support defining a single <code>broadcast-element</code>. This can be one of the 4 vector components <code>x|y|z|w</code>. Take the following for an example: <code>(.add.x.xyzw vf10, vf20, vf30)</code>, translates into:</p><div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">vf10</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> vf20</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> vf30</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vf10</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">y</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> vf20</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">y</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> vf30</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vf10</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">z</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> vf20</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">z</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> vf30</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vf10</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">w</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> vf20</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">w</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> vf30</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="three-operand-vector-float-operations-with-the-accumulator">Three operand vector float operations with the accumulator<a class="hash-link" href="#three-operand-vector-float-operations-with-the-accumulator" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.&lt;op-name&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">.&lt;broadcast-element&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">.vf dst src0 src1 acc </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:mask</span><span class="token plain"> #b&lt;0-15&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>There are a few functions that will perform multiple operations involving the accumulator. We support the following <code>op-name</code>s:</p><ul><li><code>add.mul</code> - Calculate the product of <code>src0</code> and <code>src1</code> and add it to the value of <code>acc</code> =&gt; <code>acc + (src0 * src1)</code></li><li><code>sub.mul</code> - Calculate the product of <code>src0</code> and <code>src1</code> and subtract it from the value of <code>acc</code> =&gt; <code>acc - (src0 * src1)</code></li></ul><p>An optional <code>:mask</code> value can be provided as a binary number between 0-15 (inclusive). This determines <em>which</em> of the resulting elements will be committed to the destination vector. For example, <code>:mask #b1011</code> means that the <code>w</code>, <code>y</code> and <code>x</code> results will be committed. Note that the components are defined left-to-right which may be a little counter-intuitive -- <code>w</code> is the left-most, <code>x</code> is the right-most. This aligns with the PS2&#x27;s VU implementation.</p><p>Additionally, all of these operations support defining a single <code>broadcast-element</code>. This can be one of the 4 vector components <code>x|y|z|w</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="absvf"><code>.abs.vf</code><a class="hash-link" href="#absvf" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.abs.vf dst src </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:mask</span><span class="token plain"> #b&lt;0-15&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Calculates the absolute value of the <code>src</code> vector, and stores in the <code>dst</code> vector.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="divvf-and-sqrtvf"><code>.div.vf</code> and <code>.sqrt.vf</code><a class="hash-link" href="#divvf-and-sqrtvf" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.div.vf dst src1 src2 </span><span class="token lisp-property property">:ftf</span><span class="token plain"> #b&lt;0-3&gt; </span><span class="token lisp-property property">:fsf</span><span class="token plain"> #b&lt;0-3&gt; </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Calculates the quotient of <em>one</em> of <code>src1</code>&#x27;s components specified by <code>fsf</code> <em>one</em> of <code>src2</code>&#x27;s components specified by <code>ftf</code> and stores in every component of <code>dst</code></p><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.sqrt.vf dst src </span><span class="token lisp-property property">:ftf</span><span class="token plain"> #b&lt;0-3&gt; </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Calculates the square-root of <em>one</em> of <code>src</code>&#x27;s components specified by <code>ftf</code> and stores in every component of <code>dst</code></p><p>These instructions are interesting as they behave differently than the other math operations. In the original VU, results were stored in a seperate <code>Q</code> register, which was <em>NOT</em> 128-bit. Instead it was a 32-bit register, meaning you have to pick which component from <code>src</code> you want to use. <code>:fsf</code> and <code>:ftf</code> are used to accomplish this, as usual, this is through bit flags -- <code>00</code> will select <code>x</code> and <code>11</code> will select <code>w</code>.</p><p>As <code>dst</code> is just yet another vector / xmm register in x86, things are kept simple and the quotient is copied to <em>all</em> packed single-float positions. This allows:</p><ul><li>Selecting any of the resulting vector slots will be equal to the quotient.</li><li>Since the low-floating-point (X) is defined, the xmm register should function as expected for normal math operations</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="outerproductvf"><code>.outer.product.vf</code><a class="hash-link" href="#outerproductvf" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.outer.product.vf dst src1 src2 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Calculates the outer-product of <code>src1</code> and <code>src2</code> and stores the result in <code>dst</code>. <em>ONLY</em> the x,y,z components are considered, and <code>dst</code>&#x27;s <code>w</code> component will be untouched. The following example illustrates what the outer-product is:</p><p>Given 2 vectors <code>V1 = &lt;1,2,3,4&gt;</code> and <code>V2 = &lt;5,6,7,8&gt;</code> and assume <code>VDEST = &lt;0, 0, 0, 999&gt;</code>
The outer product is computed like so (only x,y,z components are operated on):</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">x = (V1y * V2z) - (V2y * V1z) =&gt; (2 * 7) - (6 * 3) =&gt; -4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">y = (V1z * V2x) - (V2z * V1x) =&gt; (3 * 5) - (7 * 1) =&gt;  8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">z = (V1x * V2y) - (V2x * V1y) =&gt; (1 * 6) - (5 * 2) =&gt; -4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">w = N/A, left alone                                =&gt; 999</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><code>VDEST = &lt;-4, 8, -4, 999&gt;</code></p></blockquote><p>This is equivalent to the following on the PS2:</p><div class="language-mips codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-mips codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">vopmula.xyz acc src1 src2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vopmsub.xyz dst src2 src1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="blendvf"><code>.blend.vf</code><a class="hash-link" href="#blendvf" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.blend.vf dst src0 src1 mask </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Wrapper around <code>vblendps</code> (VEX xmm128 version) instruction. The <code>mask</code> must evaluate to a constant integer at compile time. The integer must be in the range of 0-15.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="itofvf-and-ftoivf"><code>.itof.vf</code> and <code>.ftoi.vf</code><a class="hash-link" href="#itofvf-and-ftoivf" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.itof.vf dst src </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:mask</span><span class="token plain"> mask-val</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.ftoi.vf dst src </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:mask</span><span class="token plain"> mask-val</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Wrapper around <code>vcvtdq2ps</code> and <code>vcvtps2dq</code> to convert packed 32-bit signed integers to packed 32-bit floats and back. The <code>mask</code> and <code>color</code> arguments behave like other assembly operations.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pwsra-pwsrl-and-pwsll"><code>.pw.sra</code>, <code>.pw.srl</code>, and <code>pw.sll</code><a class="hash-link" href="#pwsra-pwsrl-and-pwsll" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.pw.sra dst src shift-amount </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:mask</span><span class="token plain"> mask-val</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.pw.srl dst src shift-amount </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:mask</span><span class="token plain"> mask-val</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.pw.sll dst src shift-amount </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:mask</span><span class="token plain"> mask-val</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Wrapper around <code>vpsrld</code>, <code>vpsrad</code>, and <code>vpslld</code>. Does shifts on each of the 4 32-bit integers in the register.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pextlw-pextuw-pcpyud-pcpyld-pceqw-ppach"><code>.pextlw</code>, <code>.pextuw</code>, <code>.pcpyud</code>, <code>.pcpyld</code>, <code>.pceqw</code>, <code>.ppach</code><a class="hash-link" href="#pextlw-pextuw-pcpyud-pcpyld-pceqw-ppach" title="Direct link to heading">​</a></h3><div class="language-lisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lisp codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.pextlw dst src0 src1 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.pextuw dst src0 src1 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.pcpyud dst src0 src1 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.pcpyld dst src0 src1 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.pceqw dst src0 src1 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token lisp-property property">:color</span><span class="token plain"> #t|#f</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">.ppach dest src0 src1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Equivalents of the EE&#x27;s MMI instructions with the same name. These can only be used on 128-bit variables. Most map to single x86 instructions:</p><ul><li><code>pextlw</code> is <code>VPUNPCKLDQ</code> (sources swapped)</li><li><code>pextuw</code> is <code>VPUNPCKHDQ</code> (sources swapped)</li><li><code>pcpyld</code> is <code>VPUNPCKLQDQ</code> (sources swapped)</li><li><code>pcpyud</code> is <code>VPUNPCKHQDQ</code> (sources <em>not</em> swapped)</li><li><code>pceqw</code> is <code>VPCMPEQD</code></li></ul><p>Some map to multiple instructions. These must use the coloring system.</p><ul><li><code>ppach</code> is a sequence of 7 instructions (<code>VPSHUFLW</code>, <code>VPSHUFHW</code>, <code>VPSRLDQ</code>, <code>VPUNPCKLQDQ</code>).</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="todo">TODO<a class="hash-link" href="#todo" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="things-related-to-enums">Things related to enums<a class="hash-link" href="#things-related-to-enums" title="Direct link to heading">​</a></h3><p>Not yet implemented</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="defmacro"><code>defmacro</code><a class="hash-link" href="#defmacro" title="Direct link to heading">​</a></h3><h3 class="anchor anchorWithStickyNavbar_LWe7" id="loop-forms">Loop forms<a class="hash-link" href="#loop-forms" title="Direct link to heading">​</a></h3><h3 class="anchor anchorWithStickyNavbar_LWe7" id="-5"><code>&amp;</code><a class="hash-link" href="#-5" title="Direct link to heading">​</a></h3><h3 class="anchor anchorWithStickyNavbar_LWe7" id="--1"><code>-&gt;</code><a class="hash-link" href="#--1" title="Direct link to heading">​</a></h3><h3 class="anchor anchorWithStickyNavbar_LWe7" id="type">Type<a class="hash-link" href="#type" title="Direct link to heading">​</a></h3><h3 class="anchor anchorWithStickyNavbar_LWe7" id="compile-time-size-stuff">Compile-Time Size stuff<a class="hash-link" href="#compile-time-size-stuff" title="Direct link to heading">​</a></h3><h3 class="anchor anchorWithStickyNavbar_LWe7" id="object-new"><code>object-new</code><a class="hash-link" href="#object-new" title="Direct link to heading">​</a></h3></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/open-goal/open-goal.github.io/tree/master/documentation/reference/lib.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_eYIM" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vbeJ"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/reference/syntax"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">OpenGOAL Syntax &amp; Examples</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/reference/reader"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Reader</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#runtime-functions" class="table-of-contents__link toc-highlight">Runtime Functions</a><ul><li><a href="#string-symbol" class="table-of-contents__link toc-highlight"><code>string-&gt;symbol</code></a></li><li><a href="#symbol-string" class="table-of-contents__link toc-highlight"><code>symbol-&gt;string</code></a></li><li><a href="#format" class="table-of-contents__link toc-highlight"><code>format</code></a></li></ul></li><li><a href="#block-forms" class="table-of-contents__link toc-highlight">Block Forms</a><ul><li><a href="#begin" class="table-of-contents__link toc-highlight"><code>begin</code></a></li><li><a href="#block" class="table-of-contents__link toc-highlight"><code>block</code></a></li><li><a href="#return-from" class="table-of-contents__link toc-highlight"><code>return-from</code></a></li><li><a href="#return" class="table-of-contents__link toc-highlight"><code>return</code></a></li><li><a href="#label" class="table-of-contents__link toc-highlight"><code>label</code></a></li><li><a href="#goto" class="table-of-contents__link toc-highlight"><code>goto</code></a></li><li><a href="#top-level" class="table-of-contents__link toc-highlight"><code>top-level</code></a></li></ul></li><li><a href="#control-flow-forms" class="table-of-contents__link toc-highlight">Control Flow Forms</a><ul><li><a href="#goal-two-element-conditions" class="table-of-contents__link toc-highlight">GOAL &quot;Two Element&quot; Conditions</a></li><li><a href="#not" class="table-of-contents__link toc-highlight"><code>not</code></a></li><li><a href="#when-goto" class="table-of-contents__link toc-highlight"><code>when-goto</code></a></li><li><a href="#cond" class="table-of-contents__link toc-highlight"><code>cond</code></a></li><li><a href="#if" class="table-of-contents__link toc-highlight"><code>if</code></a></li><li><a href="#when" class="table-of-contents__link toc-highlight"><code>when</code></a></li><li><a href="#unless" class="table-of-contents__link toc-highlight"><code>unless</code></a></li></ul></li><li><a href="#definition-forms" class="table-of-contents__link toc-highlight">Definition Forms</a><ul><li><a href="#set" class="table-of-contents__link toc-highlight"><code>set!</code></a></li><li><a href="#define" class="table-of-contents__link toc-highlight"><code>define</code></a></li><li><a href="#define-extern" class="table-of-contents__link toc-highlight"><code>define-extern</code></a></li><li><a href="#let" class="table-of-contents__link toc-highlight"><code>let</code></a></li><li><a href="#let-1" class="table-of-contents__link toc-highlight"><code>let*</code></a></li></ul></li><li><a href="#functions" class="table-of-contents__link toc-highlight">Functions</a><ul><li><a href="#defun" class="table-of-contents__link toc-highlight"><code>defun</code></a></li><li><a href="#defmethod" class="table-of-contents__link toc-highlight"><code>defmethod</code></a></li><li><a href="#inline" class="table-of-contents__link toc-highlight"><code>inline</code></a></li><li><a href="#lambda" class="table-of-contents__link toc-highlight"><code>lambda</code></a></li><li><a href="#declare" class="table-of-contents__link toc-highlight"><code>declare</code></a></li><li><a href="#local-vars" class="table-of-contents__link toc-highlight"><code>local-vars</code></a></li></ul></li><li><a href="#macro-forms" class="table-of-contents__link toc-highlight">Macro Forms</a><ul><li><a href="#cond-1" class="table-of-contents__link toc-highlight"><code>#cond</code></a></li><li><a href="#quote--" class="table-of-contents__link toc-highlight"><code>quote</code> / <code>&#39;</code></a></li><li><a href="#defglobalconstant" class="table-of-contents__link toc-highlight"><code>defglobalconstant</code></a></li><li><a href="#mlet" class="table-of-contents__link toc-highlight"><code>mlet</code></a></li></ul></li><li><a href="#math-forms" class="table-of-contents__link toc-highlight">Math Forms</a><ul><li><a href="#-2" class="table-of-contents__link toc-highlight"><code>+</code></a></li><li><a href="#-" class="table-of-contents__link toc-highlight"><code>-</code></a></li><li><a href="#-3" class="table-of-contents__link toc-highlight"><code>*</code></a></li><li><a href="#-4" class="table-of-contents__link toc-highlight"><code>/</code></a></li><li><a href="#mod" class="table-of-contents__link toc-highlight"><code>mod</code></a></li><li><a href="#slhv-sarv-shrv" class="table-of-contents__link toc-highlight"><code>slhv</code>, <code>sarv</code>, <code>shrv</code></a></li><li><a href="#logand" class="table-of-contents__link toc-highlight"><code>logand</code></a></li><li><a href="#logior" class="table-of-contents__link toc-highlight"><code>logior</code></a></li><li><a href="#logxor" class="table-of-contents__link toc-highlight"><code>logxor</code></a></li><li><a href="#lognot" class="table-of-contents__link toc-highlight"><code>lognot</code></a></li></ul></li><li><a href="#type-forms" class="table-of-contents__link toc-highlight">Type Forms</a><ul><li><a href="#defmethod-1" class="table-of-contents__link toc-highlight"><code>defmethod</code></a></li><li><a href="#deftype" class="table-of-contents__link toc-highlight"><code>deftype</code></a></li><li><a href="#method-of-object" class="table-of-contents__link toc-highlight"><code>method-of-object</code></a></li><li><a href="#method-of-type" class="table-of-contents__link toc-highlight"><code>method-of-type</code></a></li><li><a href="#car-and-cdr" class="table-of-contents__link toc-highlight"><code>car</code> and <code>cdr</code></a></li><li><a href="#new" class="table-of-contents__link toc-highlight"><code>new</code></a></li><li><a href="#print-type" class="table-of-contents__link toc-highlight"><code>print-type</code></a></li><li><a href="#the" class="table-of-contents__link toc-highlight"><code>the</code></a></li><li><a href="#the-as" class="table-of-contents__link toc-highlight"><code>the-as</code></a></li><li><a href="#size-of" class="table-of-contents__link toc-highlight"><code>size-of</code></a></li><li><a href="#pointer-math" class="table-of-contents__link toc-highlight">Pointer Math</a></li></ul></li><li><a href="#inline-assembly-forms" class="table-of-contents__link toc-highlight">Inline Assembly Forms</a><ul><li><a href="#rlet" class="table-of-contents__link toc-highlight"><code>rlet</code></a></li><li><a href="#sub" class="table-of-contents__link toc-highlight"><code>.sub</code></a></li><li><a href="#add" class="table-of-contents__link toc-highlight"><code>.add</code></a></li><li><a href="#jr" class="table-of-contents__link toc-highlight"><code>.jr</code></a></li><li><a href="#load-sym" class="table-of-contents__link toc-highlight"><code>.load-sym</code></a></li><li><a href="#push" class="table-of-contents__link toc-highlight"><code>.push</code></a></li><li><a href="#pop" class="table-of-contents__link toc-highlight"><code>.pop</code></a></li><li><a href="#ret" class="table-of-contents__link toc-highlight"><code>.ret</code></a></li><li><a href="#mov" class="table-of-contents__link toc-highlight"><code>.mov</code></a></li><li><a href="#nopvf" class="table-of-contents__link toc-highlight"><code>.nop.vf</code></a></li><li><a href="#nop-or-nop" class="table-of-contents__link toc-highlight"><code>.nop</code> or <code>(nop!)</code></a></li><li><a href="#waitvf" class="table-of-contents__link toc-highlight"><code>.wait.vf</code></a></li><li><a href="#lvf" class="table-of-contents__link toc-highlight"><code>.lvf</code></a></li><li><a href="#svf" class="table-of-contents__link toc-highlight"><code>.svf</code></a></li><li><a href="#three-operand-vector-float-operations" class="table-of-contents__link toc-highlight">Three operand vector float operations.</a></li><li><a href="#three-operand-vector-float-operations-with-the-accumulator" class="table-of-contents__link toc-highlight">Three operand vector float operations with the accumulator</a></li><li><a href="#absvf" class="table-of-contents__link toc-highlight"><code>.abs.vf</code></a></li><li><a href="#divvf-and-sqrtvf" class="table-of-contents__link toc-highlight"><code>.div.vf</code> and <code>.sqrt.vf</code></a></li><li><a href="#outerproductvf" class="table-of-contents__link toc-highlight"><code>.outer.product.vf</code></a></li><li><a href="#blendvf" class="table-of-contents__link toc-highlight"><code>.blend.vf</code></a></li><li><a href="#itofvf-and-ftoivf" class="table-of-contents__link toc-highlight"><code>.itof.vf</code> and <code>.ftoi.vf</code></a></li><li><a href="#pwsra-pwsrl-and-pwsll" class="table-of-contents__link toc-highlight"><code>.pw.sra</code>, <code>.pw.srl</code>, and <code>pw.sll</code></a></li><li><a href="#pextlw-pextuw-pcpyud-pcpyld-pceqw-ppach" class="table-of-contents__link toc-highlight"><code>.pextlw</code>, <code>.pextuw</code>, <code>.pcpyud</code>, <code>.pcpyld</code>, <code>.pceqw</code>, <code>.ppach</code></a></li></ul></li><li><a href="#todo" class="table-of-contents__link toc-highlight">TODO</a><ul><li><a href="#things-related-to-enums" class="table-of-contents__link toc-highlight">Things related to enums</a></li><li><a href="#defmacro" class="table-of-contents__link toc-highlight"><code>defmacro</code></a></li><li><a href="#loop-forms" class="table-of-contents__link toc-highlight">Loop forms</a></li><li><a href="#-5" class="table-of-contents__link toc-highlight"><code>&amp;</code></a></li><li><a href="#--1" class="table-of-contents__link toc-highlight"><code>-&gt;</code></a></li><li><a href="#type" class="table-of-contents__link toc-highlight">Type</a></li><li><a href="#compile-time-size-stuff" class="table-of-contents__link toc-highlight">Compile-Time Size stuff</a></li><li><a href="#object-new" class="table-of-contents__link toc-highlight"><code>object-new</code></a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 OpenGOAL. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.9bd2fce1.js"></script>
<script src="/assets/js/main.042d6f4a.js"></script>
</body>
</html>